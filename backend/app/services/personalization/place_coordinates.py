# ì¥ì†Œë³„ ì¢Œí‘œ ë°ì´í„°
PLACE_COORDINATES = {
    # ì–´ë¦°ì´ê³µì›
    "ì–´ë¦°ì´ ë†€ì´í„°": {"lat": 37.5839, "lng": 127.0559},
    "ë§ˆë¡œë‹ˆì— ì–´ë¦°ì´ ê³µì›": {"lat": 37.5840, "lng": 127.0560},
    "ëŠ˜ë´„ ì–´ë¦°ì´ ê³µì›": {"lat": 37.5841, "lng": 127.0561},
    "ìƒ›ë³„ ì–´ë¦°ì´ ê³µì›": {"lat": 37.5842, "lng": 127.0562},
    "í•œë‚´ ì–´ë¦°ì´ ê³µì›": {"lat": 37.5843, "lng": 127.0563},
    "ì•„ë¦„ë“œë¦¬ ì–´ë¦°ì´ ê³µì›": {"lat": 37.5844, "lng": 127.0564},
    "í™œí„° ì–´ë¦°ì´ ê³µì›": {"lat": 37.5845, "lng": 127.0565},
    "ìš°ì‚°ê° ì–´ë¦°ì´ ê³µì›": {"lat": 37.5846, "lng": 127.0566},
    "ë°©ì•„ë‹¤ë¦¬ ì–´ë¦°ì´ ê³µì›": {"lat": 37.5847, "lng": 127.0567},
    
    # ì¼ë°˜ê³µì›
    "ì¥ì•ˆ ê·¼ë¦° ê³µì›": {"lat": 37.5848, "lng": 127.0568},
    "ì¥ë¯¸ ê³µì›": {"lat": 37.5849, "lng": 127.0569},
    "ì¥í‰ ê·¼ë¦° ê³µì›": {"lat": 37.5850, "lng": 127.0570},
    "ì´ˆí™”ì›": {"lat": 37.5851, "lng": 127.0571},
    "ê°„ë°ë©” ê³µì›": {"lat": 37.5852, "lng": 127.0572},
    "ìš©ë‘ ê³µì›": {"lat": 37.5853, "lng": 127.0573},
    
    # ì‚°
    "ë°°ë´‰ì‚°": {"lat": 37.5854, "lng": 127.0574},
    "ì²œì¥ì‚°": {"lat": 37.5855, "lng": 127.0575},
    
    # í•˜ì²œ
    "ì •ë¦‰ì²œ": {"lat": 37.5856, "lng": 127.0576},
    "ì¤‘ë‘ì²œ": {"lat": 37.5857, "lng": 127.0577},
    "ì„±ë¶ì²œ": {"lat": 37.5858, "lng": 127.0578},
    "ì²­ê³„ì²œ": {"lat": 37.5859, "lng": 127.0579}
}

def get_place_coordinates(place_name):
    """ì¥ì†Œëª…ìœ¼ë¡œ ì¢Œí‘œ ë°˜í™˜"""
    return PLACE_COORDINATES.get(place_name)

def get_latest_visited_coordinates(user_history):
    """ì‚¬ìš©ì íˆìŠ¤í† ë¦¬ì—ì„œ ê°€ì¥ ìµœê·¼ ë°©ë¬¸í•œ ì¥ì†Œì˜ ì¢Œí‘œ ë°˜í™˜"""
    if not user_history or len(user_history) == 0:
        return None
    
    # ê°€ì¥ ìµœê·¼ ê¸°ë¡ì—ì„œ ì¥ì†Œëª… ì¶”ì¶œ
    latest_route = user_history[0]
    place_name = latest_route.get('title', '')
    
    # ì´ëª¨ì§€ ì œê±°
    if place_name:
        # ì´ëª¨ì§€ ì œê±° (ğŸŸ , ğŸŸ¢, ğŸ”µ ë“±)
        import re
        place_name = re.sub(r'[ğŸŸ ğŸŸ¢ğŸ”µğŸŸ¡ğŸŸ£ğŸ”´âšªâš«]', '', place_name).strip()
        
        # ì¢Œí‘œ ë°˜í™˜
        return get_place_coordinates(place_name)
    
    return None
