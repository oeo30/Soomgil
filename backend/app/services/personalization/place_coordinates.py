# ì¥ì†Œë³„ ì¢Œí‘œ ë°ì´í„°
PLACE_COORDINATES = {
    # ì–´ë¦°ì´ê³µì›
    "ì–´ë¦°ì´ ë†€ì´í„°": {"lat": 37.5934438, "lng": 127.0674375},
    "ë§ˆë¡œë‹ˆì— ì–´ë¦°ì´ ê³µì›": {"lat": 37.5745424, "lng": 127.0739931},
    "ëŠ˜ë´„ ì–´ë¦°ì´ ê³µì›": {"lat": 37.5713740, "lng": 127.0726104},
    "ìƒ›ë³„ ì–´ë¦°ì´ ê³µì›": {"lat": 37.5679389, "lng": 127.0675625},
    "í•œë‚´ ì–´ë¦°ì´ ê³µì›": {"lat": 37.5676605, "lng": 127.0707280},
    "ì•„ë¦„ë“œë¦¬ ì–´ë¦°ì´ ê³µì›": {"lat": 37.5785901, "lng": 127.0595040},
    "í™œí„° ì–´ë¦°ì´ ê³µì›": {"lat": 37.5768133, "lng": 127.0538770},
    "ìš°ì‚°ê° ì–´ë¦°ì´ ê³µì›": {"lat": 37.5737092, "lng": 127.0247380},
    "ë°©ì•„ë‹¤ë¦¬ ì–´ë¦°ì´ ê³µì›": {"lat": 37.5854744, "lng": 127.0345149},

    # ì¼ë°˜ê³µì›
    "ì¥ì•ˆ ê·¼ë¦° ê³µì›": {"lat": 37.5662463, "lng": 127.0740951},
    "ì¥ë¯¸ ê³µì›": {"lat": 37.5716923, "lng": 127.0691611},
    "ì¥í‰ ê·¼ë¦° ê³µì›": {"lat": 37.5669810, "lng": 127.0734044},
    "ì´ˆí™”ì›": {"lat": 37.5753699, "lng": 127.0540015},
    "ê°„ë°ë©” ê³µì›": {"lat": 37.5741524, "lng": 127.0483639},
    "ìš©ë‘ ê³µì›": {"lat": 37.5730693, "lng": 127.0411982},

    # ì‚°
    "ë°°ë´‰ì‚°": {"lat": 37.5818810, "lng": 127.0646100},
    "ì²œì¥ì‚°": {"lat": 37.6017060, "lng": 127.0504050},

    # í•˜ì²œ
    "ì •ë¦‰ì²œ": {"lat": 37.5767900, "lng": 127.0345490},
    "ì¤‘ë‘ì²œ": {"lat": 37.6024240, "lng": 127.0721480},
    "ì„±ë¶ì²œ": {"lat": 37.5745720, "lng": 127.0278010},
    "ì²­ê³„ì²œ": {"lat": 37.5708191, "lng": 127.0274223}
}


def get_place_coordinates(place_name):
    """ì¥ì†Œëª…ìœ¼ë¡œ ì¢Œí‘œ ë°˜í™˜"""
    return PLACE_COORDINATES.get(place_name)

def get_latest_visited_coordinates(user_history):
    """ì‚¬ìš©ì íˆìŠ¤í† ë¦¬ì—ì„œ ê°€ì¥ ìµœê·¼ ë°©ë¬¸í•œ ì¥ì†Œì˜ ì¢Œí‘œ ë°˜í™˜"""
    if not user_history or len(user_history) == 0:
        return None
    
    # ê°€ì¥ ìµœê·¼ ê¸°ë¡ì—ì„œ ì¥ì†Œëª… ì¶”ì¶œ
    latest_route = user_history[0]
    place_name = latest_route.get('title', '')
    
    # ì´ëª¨ì§€ ì œê±°
    if place_name:
        # ì´ëª¨ì§€ ì œê±° (ğŸŸ , ğŸŸ¢, ğŸ”µ ë“±)
        import re
        place_name = re.sub(r'[ğŸŸ ğŸŸ¢ğŸ”µğŸŸ¡ğŸŸ£ğŸ”´âšªâš«]', '', place_name).strip()
        
        # ì¢Œí‘œ ë°˜í™˜
        return get_place_coordinates(place_name)
    
    return None
